<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anniinan portfolio</title>
    <link href="config.yml" type="text/yaml" rel="cms-config-url" />
    <script>
        console.log('Admin Page [DIAG]: Deep State Diagnostics v3 initialized');

        // 1. Message Interceptor
        window.addEventListener("message", (event) => {
            const isOAuth = typeof event.data === 'string' && event.data.startsWith('authorization:');
            console.log('Admin Page [MSG]: Origin:', event.origin, '| OAuth Message:', isOAuth);
            if (isOAuth) {
                console.log('Admin Page [MSG]: DATA RECEIVED (Length:', event.data.length, ')');
            }
        }, false);

        // 2. Fetch Interceptor (Network Spy)
        const originalFetch = window.fetch;
        window.fetch = async (...args) => {
            const url = args[0] instanceof URL ? args[0].href : args[0];
            console.log('Admin Page [FETCH]:', url);
            try {
                const response = await originalFetch(...args);
                console.log('Admin Page [FETCH-RES]:', url, 'Status:', response.status);
                return response;
            } catch (err) {
                console.error('Admin Page [FETCH-ERR]:', url, err.message);
                throw err;
            }
        };

        // 3. Global State Monitor
        setInterval(() => {
            const state = localStorage.getItem('decap-cms-user');
            if (state) {
                console.log('Admin Page [STATE]: Session DETECTED in localStorage!');
            }
        }, 5000);
    </script>
</head>

<body>
    <script>
        console.log('Admin Page [INIT]: Page loaded at', new Date().toLocaleTimeString());
    </script>
    <script src="https://unpkg.com/decap-cms@^3.10.0/dist/decap-cms.js"></script>
</body>

</html>