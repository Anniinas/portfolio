---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const events = (await getCollection('events'))
	.sort((a, b) => a.data.date.valueOf() - b.data.date.valueOf());

const upcomingEvents = events.filter(event => event.data.date >= new Date());
const pastEvents = events.filter(event => event.data.date < new Date()).reverse();
---

<Layout title="Kalenteri | Anniina Photo">
	<section class="calendar-container">
		<h1>Kalenteri</h1>
		<p class="intro">T√§√§lt√§ n√§et tulevat tapahtumat, joissa olen mukana kuvaamassa.</p>

		<div class="events-section">
			<h2>Tulevat tapahtumat</h2>
			{upcomingEvents.length > 0 ? (
				<div class="events-list">
					{upcomingEvents.map((event) => (
						<article class="event-item">
							<div class="event-date">
								<span class="day">{event.data.date.getDate()}</span>
								<span class="month">{event.data.date.toLocaleDateString('fi-FI', { month: 'short' })}</span>
							</div>
							<div class="event-main">
								<div class="event-header">
									<h3>{event.data.title}</h3>
									<span class="location">üìç {event.data.location}</span>
								</div>
								{event.body && <div class="description">{event.body}</div>}
							</div>
						</article>
					))}
				</div>
			) : (
				<p class="empty-state">Ei tiedossa olevia tulevia tapahtumia t√§ll√§ hetkell√§.</p>
			)}
		</div>

		{pastEvents.length > 0 && (
			<div class="events-section past-events">
				<h2>Menneet tapahtumat</h2>
				<div class="events-list simple">
					{pastEvents.map((event) => (
						<div class="past-event-item">
							<time datetime={event.data.date.toISOString()}>
								{event.data.date.toLocaleDateString('fi-FI')}
							</time>
							<span class="title">{event.data.title}</span>
							<span class="location">{event.data.location}</span>
						</div>
					))}
				</div>
			</div>
		)}
	</section>
</Layout>

<style>
	.calendar-container {
		padding: 3rem 0;
	}

	h1 {
		font-size: 3rem;
		margin-bottom: 1rem;
	}

	.intro {
		color: var(--muted-color);
		max-width: 600px;
		margin-bottom: 4rem;
		font-size: 1.1rem;
		letter-spacing: 0.15em;
	}

	.events-section {
		margin-bottom: 5rem;
	}

	h2 {
		font-size: 2rem;
		margin-bottom: 2rem;
		border-bottom: 1px solid var(--secondary-color);
		padding-bottom: 0.5rem;
	}

	.events-list {
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
	}

	.event-item {
		background: rgba(26, 26, 26, 0.4);
		backdrop-filter: blur(10px);
		-webkit-backdrop-filter: blur(10px);
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: 12px;
		padding: 1.5rem 2rem;
		display: flex;
		gap: 2rem;
		align-items: center;
		transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease;
		border-left: 4px solid var(--accent-color);
	}

	.event-item:hover {
		transform: translateX(10px);
		background: rgba(255, 255, 255, 0.05);
		border-color: rgba(255, 255, 255, 0.2);
	}

	.event-date {
		background: rgba(0, 0, 0, 0.5);
		padding: 0.75rem;
		border-radius: 8px;
		display: flex;
		flex-direction: column;
		align-items: center;
		min-width: 80px;
		border: 1px solid rgba(255, 255, 255, 0.1);
	}

	.event-date .day {
		font-size: 1.5rem;
		font-weight: 700;
		font-family: 'Outfit', sans-serif;
	}

	.event-date .month {
		font-size: 0.8rem;
		text-transform: uppercase;
		color: var(--muted-color);
		font-weight: 700;
	}

	.event-main {
		flex: 1;
	}

	.event-header {
		display: flex;
		justify-content: space-between;
		align-items: baseline;
		gap: 1rem;
		flex-wrap: wrap;
		margin-bottom: 0.5rem;
	}

	.event-header h3 {
		margin: 0;
		font-size: 1.4rem;
	}

	.location {
		color: var(--accent-color);
		font-weight: 700;
		font-size: 0.9rem;
	}

	.description {
		font-size: 1rem;
		line-height: 1.5;
		color: var(--muted-color);
	}

	.past-events {
		opacity: 0.7;
	}

	.events-list.simple {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}

	.past-event-item {
		display: grid;
		grid-template-columns: 100px 1fr 1fr;
		padding: 1rem;
		border-bottom: 1px solid var(--secondary-color);
		font-size: 0.9rem;
	}

	.past-event-item time {
		color: var(--muted-color);
	}

	.past-event-item .title {
		font-weight: 700;
	}

	.past-event-item .location {
		margin: 0;
		text-align: right;
	}

	@media (max-width: 768px) {
		.event-item {
			flex-direction: column;
			align-items: flex-start;
			gap: 1rem;
			padding: 1.5rem;
		}

		.event-date {
			flex-direction: row;
			gap: 0.5rem;
			min-width: unset;
			padding: 0.5rem 1rem;
		}

		.event-header {
			flex-direction: column;
			gap: 0.25rem;
		}
	}

	@media (max-width: 600px) {
		.past-event-item {
			grid-template-columns: 1fr;
			gap: 0.5rem;
		}

		.past-event-item .location {
			text-align: left;
		}
	}
</style>
